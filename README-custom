* 基本情報
- これは、改造されたChatonです。
- Chatonについての基本情報は、以下を見てください。
-- README
-- http://practical-scheme.net/chaton/
- この改造の元になったChatonのバージョンは、以下の通りです。
-- http://chaton.svn.sourceforge.net/viewvc/chaton/Chaton/trunk/
   の、 revision 154
- この改造自体は、以下のURLに置かれます。
-- https://github.com/ayamada/chaton-custom-tir


* 主な変更内容
- Read Archve の「本日のログ」の内容の厳密化/可視化
- 各日付が内部ではGMTで扱われるようになっていたものを、
  またlocaltimeへとデグレード
  (前述のRead Archiveの日付の厳密化との整合性を取る為)
- 組み込みのログ検索機能
-- basic認証等をかけた為に、 search.html による外部の検索機能が
   使えなくなってしまった為の代用品
-- 単純な線形検索なので、ログが増えるにつれ重くなる
- w3mや携帯端末等の、JavaScript制御のできないブラウザの為の簡易クライアントcgi
- 一部の文章のローカライズ(というか単に追加文言を日本語で書いただけ)
- 一部の見た目にのみ関わる調整(部屋名の位置変更、toolへのリンクを外す等)
- その他細かい変更


* 追加されたファイル
- README-custom このファイル
- chaton-search 前述の、組み込みのログ検索cgi
- chaton-mobile 前述の、JavaScript非対応ブラウザの為の簡易クライアントcgi


* TODO
- chaton-searchのテンプレートにsearch.htmlを使わないようにする
  (テンプレートを自前で持つか、chaton-browserのものを流用する)
- chaton-mobileの作成
- chaton-search, chaton-mobileは単独でも追加できるようにする
-- chaton.scmを無改造の状態に戻し、必要な手続きはimportで直に取り出すようにする
-- 日時をGMTで扱うかlocaltimeで扱うかを、*hoge*系の変数で設定できるようにする
- chaton-searchの検索対象は、行単位ではなく、日単位とする？
-- スイッチで動作を変更できるべきでは
- chaton-entryの、元々tools等のリンクがあった場所に、*.conf設定で、
  説明文を入れられるようにする(仮)
-- 現状の room-description での説明文はrss等にも入ってしまう、
   「chat部屋自体の詳細」なので、
-- Read Archive 等のリンクもこの扱いにしてしまう？
- 部屋別にbasic認証をかけたりかけなかったりできるような、htaccess制御
- chaton-searchでfindを使わないように直す


* 改造方針
- 上流が更新された際にバージョンアップしやすいように、
  なるべく元ファイルの状態を温存する
- しかし上流へ還元する事はあまり考えない
-- 拡張した部分では日本語を使いまくる
- この改造での各機能は、個別に反映しやすいような構造とする
-- 手続き等を各ファイルで共有する事は基本的には行わない
-- ただし元から存在するファイル(chaton.scm等)の手続き等を参照する事は
   積極的に行う。この場合はコピペはなるべく行わない。
--- exportされていない手続き等を利用する場合は、元ファイルの方をいじって
    exportするのではなく、呼び出し側のファイルから明示的にimportを行う
    (なるべく元ファイルの状態を温存したい為)


* chaton-search, chaton-mobileのみを導入する際の注意点
- build-site と htaccess も持っていく/変更する必要があります
-- build-site は、make install時にcharon-search等を反映する為に必要
-- htaccess は、新たに追加になったファイルをcgi動作させる為に必要
- 各ファイルの、日付判定厳密化の為の有効無効フラグを書き換える必要があるかも
-- 詳細はあとでまとめる
- (optional) chaton-entryを書き換える
  (chaton-search, chaton-mobileへのリンクを入れる)


* その他のメモ
- 本体のバージョンが上がった際には、git rebaseでバージョンアップできるかも
  (できないかも)
- Chatonは、内部encodingがutf-8のGaucheでないと動きません。
  (少なくとも、最初に元にしたrevision 154では)
  いい機会なので、環境のutf-8化をしてしまいましょう。



